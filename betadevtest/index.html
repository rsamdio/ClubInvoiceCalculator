<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdnjs.cloudflare.com https://www.googletagmanager.com https://www.gstatic.com https://apis.google.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.tailwindcss.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://www.google-analytics.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com https://firestore.googleapis.com https://accounts.google.com; frame-src 'self' https://clubinvoicecalculator.firebaseapp.com/ https://accounts.google.com; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    
    <title>Rotaract Club Invoice Calculator | Rotaract South Asia MDIO</title>

	<meta name="description" content="Rotaract Club Invoice Calculator is an interactive tool by Rotaract South Asia MDIO (RSAMDIO) to help Rotaractors estimate their Club Invoices with precision and ease.">
    <meta name="author" content="ZeoSpec">

    <link rel="canonical" href="https://dues.rsamdio.org/"> 

    <meta property="og:title" content="Rotaract Club Invoice Calculator | Rotaract South Asia MDIO">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://dues.rsamdio.org/">
    <meta property="og:site_name" content="Rotaract Club Invoice Calculator | Rotaract South Asia MDIO" />
    <meta property="og:image" content="https://dues.rsamdio.org/calculatorogimg.png" />
    <meta property="og:description" content="Rotaract Club Invoice Calculator is an interactive tool by Rotaract South Asia MDIO (RSAMDIO) to help Rotaractors estimate their Club Invoices with precision and ease.">
    
    <meta name="keywords" content="Rotaract Club Invoice Calculator, Rotaract Dues Calculator, Rotary Club Dues, RSAMDIO Calculator, Rotaract South Asia MDIO, Club Invoice Tool, RI Dues Calculator, Rotaract Membership Dues, Rotary International Dues, Club Invoice Generator, Rotaract Financial Calculator, Membership Dues Tool, Rotaract Club Management, Rotary Club Financial Tool" />

    <meta name="subject" content="Rotaract Club Invoice Calculator | Rotaract South Asia MDIO">

    <meta name="url" content="https://dues.rsamdio.org/">
    <meta name="identifier-URL" content="https://dues.rsamdio.org/">
    
    <meta http-equiv="cache-control" content="public" />
    <meta http-equiv="Expires" content="0">
    
    <!-- SEO Meta Tags -->
    <meta name="robots" content="noindex, nofollow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="noindex, nofollow">
    <!-- <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow"> -->
    <meta name="author" content="Rotaract South Asia MDIO">
    <meta name="copyright" content="Rotaract South Asia MDIO">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="global">
    <meta name="rating" content="general">
    <meta name="coverage" content="worldwide">
    <meta name="target" content="all">
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#004aad">
    <meta name="msapplication-TileColor" content="#004aad">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Rotaract Calculator">
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
    <link rel="icon" href="favicon.png" type="image/x-icon">
	

    <!-- Preload critical resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"></noscript>
    
    <!-- External CSS for better performance -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Optimized Tailwind CSS with local fallback -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Preload critical external scripts -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" as="script">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" as="script">
    
    <!-- Defer non-critical scripts with crossorigin for security -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" defer crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" defer crossorigin="anonymous"></script>
    <!-- Critical CSS only - rest moved to external file -->
    <style>
        /* Critical above-the-fold styles only */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
            color: #4a5568;
            margin: 0;
            padding: 0;
        }
        
        /* Essential loading states */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
    </style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4371E35K36"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-4371E35K36');
    </script>

    <!-- Preload PDF generation libraries -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" as="script">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js" as="script">
    
    <!-- jsPDF Library for PDF Generation with crossorigin for security -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js" crossorigin="anonymous"></script>
    
    <!-- External JavaScript for better performance -->
    <script src="app.js" defer></script>

    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, setDoc, getDoc, collection, addDoc, updateDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAnalytics, logEvent, setUserId } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';
        import { firebaseConfig } from './firebase-config.js';

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const analytics = getAnalytics(app);
        const provider = new GoogleAuthProvider();

        // Make Firebase available globally
        window.firebaseAuth = auth;
        window.firebaseDB = db;
        window.firebaseAnalytics = analytics;
        window.firebaseProvider = provider;
        window.firebaseSignIn = signInWithPopup;
        window.firebaseSignOut = signOut;
        window.firebaseOnAuthStateChanged = onAuthStateChanged;
        window.firebaseDoc = doc;
        window.firebaseSetDoc = setDoc;
        window.firebaseGetDoc = getDoc;
        window.firebaseCollection = collection;
        window.firebaseAddDoc = addDoc;
        window.firebaseUpdateDoc = updateDoc;
        window.firebaseLogEvent = logEvent;
        window.firebaseSetUserId = setUserId;
    </script>

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Rotaract Club Invoice Calculator",
        "description": "Interactive tool by Rotaract South Asia MDIO (RSAMDIO) to help Rotaractors estimate their Club Invoices with precision and ease.",
        "url": "https://dues.rsamdio.org/",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web Browser",
        "browserRequirements": "Requires JavaScript. Requires HTML5.",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "Rotaract South Asia MDIO",
            "url": "https://rsamdio.org/"
        },
        "creator": {
            "@type": "Organization",
            "name": "ZeoSpec",
            "url": "https://rtr.zeospec.com/"
        },
        "featureList": [
            "Individual member addition",
            "Bulk upload support",
            "Real-time calculations",
            "PDF report generation",
            "Tax percentage configuration",
            "Prorated dues calculation"
        ],
        "screenshot": "https://dues.rsamdio.org/calculatorogimg.png",
        "softwareVersion": "2.0",
        "datePublished": "2024-08-06",
        "dateModified": "2025-01-07"
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Rotaract South Asia MDIO",
        "url": "https://rsamdio.org/",
        "logo": "https://dues.rsamdio.org/rsamdio.png",
        "sameAs": [
            "https://www.instagram.com/rsamdio/",
            "https://www.facebook.com/rsamdio/",
            "https://x.com/rsa_mdio",
            "https://www.linkedin.com/company/rsamdio/",
            "https://www.youtube.com/@rsamdio"
        ],
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "customer service",
            "email": "rotaract3191drr@gmail.com"
        }
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://rsamdio.org/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Rotaract Club Invoice Calculator",
                "item": "https://dues.rsamdio.org/"
            }
        ]
    }
    </script>

</head>
<body class="antialiased">
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full mx-auto mb-4"></div>
            <h3 class="text-lg font-bold text-gray-800 mb-2">Generating Detailed Report</h3>
            <p id="loading-message" class="text-gray-600 font-medium mb-4">Preparing...</p>
            
            <div class="loading-progress">
                <div id="loading-progress-bar" class="loading-progress-bar"></div>
            </div>
            
            <div class="loading-steps">
                <div id="step-1" class="loading-step active">
                    <div class="w-2 h-2 bg-blue-500 rounded-full mb-1"></div>
                    <span>Prepare</span>
                </div>
                <div id="step-2" class="loading-step">
                    <div class="w-2 h-2 bg-gray-300 rounded-full mb-1"></div>
                    <span>Process</span>
                </div>
                <div id="step-3" class="loading-step">
                    <div class="w-2 h-2 bg-gray-300 rounded-full mb-1"></div>
                    <span>Generate</span>
                </div>
                <div id="step-4" class="loading-step">
                    <div class="w-2 h-2 bg-gray-300 rounded-full mb-1"></div>
                    <span>Complete</span>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">

        <!-- Fixed Login Component -->
        <div id="login-container" class="fixed top-4 right-4 z-50">
            <!-- Login State (Default) - Compact -->
            <div id="login-state" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-3 py-2 rounded-full shadow-lg border border-blue-400 cursor-pointer transition-all duration-200 flex items-center space-x-2 group">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                <span class="text-sm font-medium">Sign In</span>
            </div>
            
            <!-- User State (Hidden by default) - Circular Profile with Dropdown -->
            <div id="user-state" class="hidden relative">
                <!-- Profile Circle -->
                <div id="profile-trigger" class="w-12 h-12 rounded-full shadow-lg border-2 border-white cursor-pointer transition-all duration-200 hover:shadow-xl hover:scale-105 flex items-center justify-center overflow-hidden">
                    <img id="user-avatar" class="w-[90%] h-[90%] rounded-full object-cover" src="" alt="User avatar">
                </div>
                
                <!-- Dropdown Menu -->
                <div id="profile-dropdown" class="hidden absolute right-0 top-12 w-64 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 z-50 transform transition-all duration-200 opacity-0 scale-95">
                    <!-- User Info Section -->
                    <div class="px-4 py-3 border-b border-gray-100">
                        <div class="flex items-center space-x-3">
                            <img id="dropdown-avatar" class="w-10 h-10 rounded-full border-2 border-gray-200" src="" alt="User avatar">
                            <div class="flex-1 min-w-0">
                                <p id="dropdown-name" class="text-sm font-semibold text-gray-900 truncate"></p>
                                <p id="dropdown-email" class="text-xs text-gray-500 truncate"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Menu Items -->
                    <div class="py-1">
                        <button id="logout-button" class="w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-200 flex items-center space-x-3 group">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400 group-hover:text-red-500 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                            </svg>
                            <span class="group-hover:text-red-600 transition-colors">Sign out</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Loading State (Hidden by default) -->
            <div id="loading-state" class="hidden bg-white text-gray-700 px-3 py-2 rounded-full shadow-lg border border-gray-200 flex items-center space-x-2">
                <div class="animate-spin rounded-full h-4 w-4 border-2 border-gray-300 border-t-blue-600"></div>
                <span class="text-sm font-medium">Signing in...</span>
            </div>
        </div>

        <!-- Header -->
        <header class="text-center mb-12">
            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-3xl p-8 mb-8 border border-blue-100">
                <img src="rsamdio.png" alt="RSAMDIO Logo" class="mx-auto h-24 mb-6 drop-shadow-lg">
                <h1 class="text-4xl sm:text-5xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-4">Rotaract Club Invoice Calculator</h1>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto leading-relaxed">An interactive tool to help Rotaractors estimate their Club Invoices with precision and ease.</p>
                <div class="flex items-center justify-center mt-6 space-x-4 text-sm text-gray-500">
                    <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Easy to use
                    </div>
                    <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Bulk upload support
                    </div>
                    <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Real-time calculations
                    </div>
                </div>
            </div>
        </header>

        <!-- Welcome Message Area -->
        <div id="welcome-message-area" class="mb-8 hidden">
            <div class="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-2xl p-6 shadow-sm">
                <div class="flex items-start space-x-4">
                    <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center flex-shrink-0">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h3 class="text-lg font-semibold text-green-800 mb-2">Welcome to Rotaract Club Invoice Calculator!</h3>
                        <p class="text-green-700 leading-relaxed">You can start adding members to your roster and save them to the cloud. Your data will be automatically synced across devices.</p>
                    </div>
                    <button id="dismiss-welcome" class="text-green-400 hover:text-green-600 transition-colors duration-200 p-2 rounded-full hover:bg-green-100">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Left Column: Add Member & Bulk Upload -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Add New Member Card -->
                <div class="card p-6 shadow-lg border-0">
                    <div class="text-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <h2 class="text-xl font-bold text-gray-800">Add New Member</h2>
                        <p class="text-sm text-gray-500 mt-1">Add individual members to your roster</p>
                    </div>
                    <form id="add-member-form" class="space-y-5">
                        <div class="form-group space-y-2">
                            <label for="member-name" class="block text-sm font-semibold text-gray-700 text-center">Member Name <span class="text-red-500">*</span></label>
                            <input type="text" id="member-name" 
                                   class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center"
                                   placeholder="Enter member's full name"
                                   aria-describedby="member-name-error">
                            <div id="member-name-error" class="error-message text-center"></div>
                        </div>
                        <div class="form-group space-y-2">
                            <label for="member-type" class="block text-sm font-semibold text-gray-700 text-center">Club Base <span class="text-red-500">*</span></label>
                            <select id="member-type" 
                                    class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center"
                                    aria-describedby="member-type-error">
                                <option value="">Select Club Base</option>
                                <option value="Community-Based">Community Based ($8)</option>
                                <option value="University-Based">University Based ($5)</option>
                            </select>
                            <div id="member-type-error" class="error-message text-center"></div>
                        </div>
                        <div class="form-group space-y-2">
                            <label for="join-date" class="block text-sm font-semibold text-gray-700 text-center">Join Date <span class="text-red-500">*</span></label>
                            <input type="date" id="join-date" 
                                   class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center"
                                   aria-describedby="join-date-error">
                            <div id="join-date-error" class="error-message text-center"></div>
                        </div>
                        <div class="form-group space-y-2">
                            <label for="leave-date" class="block text-sm font-semibold text-gray-700 text-center">Leave Date (Optional)</label>
                            <input type="date" id="leave-date" 
                                   class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-center"
                                   placeholder="Leave blank if still active"
                                   aria-describedby="leave-date-error">
                            <div id="leave-date-error" class="error-message text-center"></div>
                        </div>
                        <button type="submit" id="add-member-button" class="btn btn-primary w-full !mt-6 py-3 text-base font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" /></svg>
                            Add Member
                        </button>
                    </form>
                </div>

                <!-- Bulk Upload Card -->
                <div class="card p-6 shadow-lg border-0">
                    <div class="text-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                            </svg>
                        </div>
                        <h2 class="text-xl font-bold text-gray-800">Bulk Upload Roster</h2>
                        <p class="text-sm text-gray-500 mt-1">Upload multiple members at once</p>
                    </div>
                    
                    <!-- File Upload Area -->
                    <div id="file-upload-area" class="file-upload-area upload-area-container p-8 text-center mb-6 bg-gradient-to-br from-gray-50 to-gray-100">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                        </svg>
                        <p class="text-base text-gray-600 mb-3 font-medium">Drag and drop your file here, or</p>
                        <input type="file" id="file-input" accept=".xlsx,.xls,.csv" class="hidden">
                        <button type="button" id="browse-button" class="btn btn-secondary text-sm px-6 py-3 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                            </svg>
                            Browse Files
                        </button>
                        <p class="text-xs text-gray-500 mt-3">Supports Excel (.xlsx, .xls) and <br><b>CSV (Recommended)</b> files </p>
                    </div>
                    
                    <!-- File Upload Error Display -->
                    <div id="file-upload-error" class="hidden mb-4"></div>
                    
                    <!-- Upload Preview -->
                    <div id="upload-preview" class="hidden mb-6">
                        <h3 class="text-sm font-bold text-gray-700 mb-3 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Preview
                        </h3>
                        <div id="preview-content" class="upload-preview bg-gray-50 p-4 rounded-lg border border-gray-200 text-sm"></div>
                        <div class="flex gap-3 mt-4">
                            <button type="button" id="confirm-upload" class="btn btn-primary text-sm flex-1 py-3 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                </svg>
                                Add to Roster
                            </button>
                            <button type="button" id="cancel-upload" class="btn btn-secondary text-sm py-3 px-4 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200">
                                Cancel
                            </button>
                        </div>
                    </div>

                    <!-- File Format Instructions -->
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-5 rounded-xl border border-blue-100 mb-6">
                        <h3 class="text-sm font-bold text-blue-800 mb-3 flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Expected File Format
                        </h3>
                        <div class="text-sm text-blue-700 space-y-2">
                            <div class="flex items-center">
                                <span class="w-7 h-7 bg-blue-200 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 mr-4 flex-shrink-0">A</span>
                                <div class="flex-1">
                                    <span class="font-semibold text-blue-800">Member Name</span>
                                    <span class="text-blue-600 ml-2">(e.g., John Doe)</span>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <span class="w-7 h-7 bg-blue-200 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 mr-4 flex-shrink-0">B</span>
                                <div class="flex-1">
                                    <span class="font-semibold text-blue-800">Join Date</span>
                                    <span class="text-blue-600 ml-2">(YYYY-MM-DD format)</span>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <span class="w-7 h-7 bg-blue-200 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 mr-4 flex-shrink-0">C</span>
                                <div class="flex-1">
                                    <span class="font-semibold text-blue-800">Club Base</span>
                                    <span class="text-blue-600 ml-2">(Community-Based or University-Based)</span>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <span class="w-7 h-7 bg-blue-200 rounded-full flex items-center justify-center text-xs font-bold text-blue-800 mr-4 flex-shrink-0">D</span>
                                <div class="flex-1">
                                    <span class="font-semibold text-blue-800">Leave Date</span>
                                    <span class="text-blue-600 ml-2">(YYYY-MM-DD format, leave blank if still active)</span>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 pt-3 border-t border-blue-200">
                            <div class="flex flex-col gap-3">
                                <button type="button" id="download-template" class="text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    Download CSV Template
                                </button>
                                <a href="https://docs.google.com/spreadsheets/d/1pn3XA_MQyHFYIA4rn1i77qes_ujE533Orw7_fC8VFc4/copy" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   class="text-sm text-green-600 hover:text-green-800 font-medium flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    Make a Copy in Google Sheets
                                </a>
                            </div>
                        </div>
                    </div>


                </div>
            </div>

            <!-- Right Column: Summary & Roster -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Invoice Summary Card -->
                <div class="card p-8 shadow-lg border-0">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Invoice Summary</h2>
                        <p class="text-gray-500">View your estimated club invoice</p>
                    </div>
                    
                    <div class="mb-8">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Invoice Year Selection -->
                            <div class="bg-gradient-to-br from-gray-50 to-blue-50 p-6 rounded-xl border border-blue-100 shadow-sm hover:shadow-md transition-all duration-300">
                                <label for="invoice-year-select" class="block text-m font-bold text-blue-700 mb-3 text-center">Invoice of January</label>
                                <select id="invoice-year-select" class="w-full px-4 py-3 border-2 border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-center font-semibold bg-white shadow-sm">
                                    <!-- Options will be populated by JavaScript -->
                                </select>
                                <div class="text-center mt-3">
                                    <div>        
                                        <p class="text-sm text-blue-600">Select the invoice year</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Tax Percentage Input -->
                            <div class="bg-gradient-to-br from-gray-50 to-green-50 p-6 rounded-xl border border-green-100 shadow-sm hover:shadow-md transition-all duration-300">
                                <label for="tax-percentage" class="block text-m font-bold text-green-700 mb-3 text-center">Tax Percentage (%)</label>
                                <div class="relative">
                                    <input type="number" id="tax-percentage" min="0" max="100" step="0.01" value="18" 
                                           class="w-full px-4 py-3 pr-12 border-2 border-green-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 text-center font-semibold bg-white shadow-sm" 
                                           placeholder="18">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <span class="text-green-600 font-semibold">%</span>
                                    </div>
                                </div>
                                <div class="text-center mt-3">
                                    <div>
                                        <p class="text-sm text-green-600">Configure tax percentage</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Local Currency Rate Input -->
                            <div class="bg-gradient-to-br from-gray-50 to-purple-50 p-6 rounded-xl border border-purple-100 shadow-sm hover:shadow-md transition-all duration-300">
                                <label for="currency-rate" class="block text-m font-bold text-purple-700 mb-3 text-center">USD to Local Rate</label>
                                <div class="relative">
                                    <input type="number" id="currency-rate" min="0" step="0.01" value="87" 
                                           class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 text-center font-semibold bg-white shadow-sm" 
                                           placeholder="87">
                                </div>
                                <div class="text-center mt-3">
                                    <div>
                                        <p class="text-sm text-purple-600">Enter exchange rate</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-8 rounded-2xl border border-blue-100 text-center">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <p class="text-lg text-blue-700 font-semibold mb-2">Base RI Dues</p>
                                <p id="base-invoice-amount" class="text-4xl font-bold text-blue-800 tracking-tight my-2">$0.00</p>
                                <p id="dues-breakdown" class="text-sm text-gray-600">Annual: $0.00 + Prorated: $0.00</p>
                            </div>
                            <div>
                                <p class="text-lg text-green-700 font-semibold mb-2">Total with Tax</p>
                                <p id="total-invoice-amount" class="text-4xl font-bold text-green-800 tracking-tight my-2">$0.00</p>
                                <p id="tax-breakdown" class="text-sm text-gray-600">Tax: $0.00 + $0.00 (18%)</p>
                            </div>
                        </div>
                        
                        <!-- Local Currency Conversion Totals -->
                        <div class="mt-6 pt-6 border-t border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <p class="text-lg text-purple-700 font-semibold mb-2">Base RI Dues (Local)</p>
                                    <p id="base-invoice-amount-local" class="text-4xl font-bold text-purple-800 tracking-tight my-2">0.00</p>
                                    <p id="dues-breakdown-local" class="text-sm text-gray-600">Annual: 0.00 + Prorated: 0.00</p>
                                </div>
                                <div>
                                    <p class="text-lg text-orange-700 font-semibold mb-2">Total with Tax (Local)</p>
                                    <p id="total-invoice-amount-local" class="text-4xl font-bold text-orange-800 tracking-tight my-2">0.00</p>
                                    <p id="tax-breakdown-local" class="text-sm text-gray-600">Tax: 0.00 + 0.00 (18%)</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Horizontal Line -->
                        <div class="border-t border-blue-200 my-6"></div>
                        
                        <!-- Additional Summary Data -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                            <div class="text-center">
                                <p class="text-sm text-gray-500 font-medium mb-1">Members</p>
                                <p id="total-members" class="text-2xl font-semibold text-gray-700 tracking-tight">0</p>
                                <p class="text-xs text-gray-400">Total Active Member Dues</p>
                            </div>
                            <div class="text-center">
                                <p class="text-sm text-gray-500 font-medium mb-1">Months</p>
                                <p id="total-prorated-months" class="text-2xl font-semibold text-gray-700 tracking-tight">0</p>
                                <p class="text-xs text-gray-400">Total Months in Prorata Calculation</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PDF Generation Section -->
                    <div class="mt-8 pt-6 border-t border-blue-200">

                        <button type="button" id="downloadPdfBtn" class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <span>Generate Detailed Report</span>
                        </button>
                        
                        <div id="pdfStatus" class="mt-3 text-center hidden">
                            <div class="inline-flex items-center space-x-2 text-blue-600">
                                <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                                <span>Generating Detailed Report...</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Member Roster Card -->
                <div class="card p-8 shadow-lg border-0">
                    <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mr-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                            </div>
                            <div>
                                <h2 class="text-xl font-bold text-gray-800">Member Roster</h2>
                                <p class="text-sm text-gray-500">Manage your club members</p>
                            </div>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-3 sm:gap-4">
                            <button id="reset-button" class="btn btn-secondary text-sm px-4 sm:px-6 py-3 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200 whitespace-nowrap">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                </svg>
                                <span class="hidden sm:inline">Reset Roster</span>
                                <span class="sm:hidden">Reset</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto -mx-8 table-responsive">
                        <table class="min-w-full" role="table" aria-label="Member roster">
                            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                                <tr>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Name</th>
                                    <th scope="col" class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider">Join Date</th>
                                    <th scope="col" class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider">Leave Date</th>
                                    <th scope="col" class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider">Club Base</th>
                                    <th scope="col" class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider">
                                        Est. Base Due
                                        <div class="text-xs font-normal text-gray-500 normal-case mt-1">(Annual + Prorated)</div>
                                    </th>
                                    <th scope="col" class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider">
                                        Est. Base Due (Local)
                                        <div class="text-xs font-normal text-gray-500 normal-case mt-1">(Annual + Prorated)</div>
                                    </th>
                                    <th scope="col" class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider">
                                        Est.Total Due (Local)
                                        <div class="text-xs font-normal text-gray-500 normal-case mt-1">(Base + Tax)</div>
                                    </th>
                                    <th scope="col" class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider">Active Member</th>
                                    <th scope="col" class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider">Prorated Months</th>
                                    <th scope="col" class="relative px-6 py-4"><span class="sr-only">Actions</span></th>
                                </tr>
                            </thead>
                            <tbody id="member-roster-body" class="bg-white divide-y divide-gray-100">
                                <!-- Rows will be dynamically injected here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination Controls -->
                    <div id="pagination-controls" class="mt-6 px-6 hidden">
                        <!-- Desktop Layout -->
                        <div class="hidden md:flex items-center justify-between flex-wrap gap-4 lg:gap-6 xl:gap-8">
                            <div class="flex items-center space-x-2 lg:space-x-3 flex-shrink-0">
                                <span class="text-sm text-gray-700 whitespace-nowrap">Show</span>
                                <select id="page-size-select" class="border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="10" selected>10</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                                <span class="text-sm text-gray-700 whitespace-nowrap">entries per page</span>
                            </div>
                            
                            <div class="flex items-center space-x-2 lg:space-x-3 flex-shrink-0">
                                <span id="pagination-info" class="text-sm text-gray-700 whitespace-nowrap">
                                    Showing <span id="start-entry">1</span> to <span id="end-entry">10</span> of <span id="total-entries">0</span> entries
                                </span>
                            </div>
                            
                            <div class="flex items-center space-x-1 lg:space-x-2 flex-shrink-0">
                                <button id="prev-page" class="px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap">
                                    Previous
                                </button>
                                <div id="page-numbers" class="flex items-center space-x-1 lg:space-x-2">
                                    <!-- Page numbers will be dynamically generated -->
                                </div>
                                <button id="next-page" class="px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap">
                                    Next
                                </button>
                            </div>
                        </div>
                        
                        <!-- Mobile Layout -->
                        <div class="md:hidden space-y-3">
                            <div class="flex items-center justify-between flex-wrap gap-2">
                                <div class="flex items-center space-x-2 flex-shrink-0">
                                    <span class="text-sm text-gray-700 whitespace-nowrap">Show</span>
                                    <select id="page-size-select-mobile" class="border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <option value="10" selected>10</option>
                                        <option value="25">25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                    <span class="text-sm text-gray-700 whitespace-nowrap">entries</span>
                                </div>
                                
                                <span id="pagination-info-mobile" class="text-sm text-gray-700 whitespace-nowrap">
                                    <span id="start-entry-mobile">1</span>-<span id="end-entry-mobile">10</span> of <span id="total-entries-mobile">0</span>
                                </span>
                            </div>
                            
                            <div class="flex items-center justify-between flex-wrap gap-2">
                                <button id="prev-page-mobile" class="px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap">
                                    Previous
                                </button>
                                
                                <div id="page-numbers-mobile" class="flex items-center space-x-1">
                                    <!-- Page numbers will be dynamically generated -->
                                </div>
                                
                                <button id="next-page-mobile" class="px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap">
                                    Next
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Empty State -->
                    <div id="empty-state" class="text-center py-12">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-gray-300 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">No members yet</h3>
                        <p class="text-gray-500 mb-4">Add members individually or upload a roster file to get started</p>
                    </div>
                </div>


            </div>
        </main>

        <!-- How Dues Are Calculated Section -->
        <section class="mt-16 mb-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Understanding RI Dues</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto">Learn about Rotary International dues structure and calculation principles</p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto">
                <!-- Dues Structure & Calculation -->
                <div class="group">
                    <div class="block bg-gradient-to-br from-blue-50 to-indigo-50 p-8 rounded-xl border border-blue-200 hover:border-blue-300 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 h-full">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
                                </svg>
                            </div>
                            <h3 class="text-xl font-bold text-blue-800 mb-3">Dues Structure & Calculation</h3>
                            <p class="text-blue-600 mb-6">Annual membership dues and how they are calculated for different scenarios</p>
                        </div>
                        
                        <div class="space-y-6">
                                                         <!-- Dues Rates -->
                             <div class="bg-white rounded-lg p-4 border border-blue-100">
                                 <h4 class="font-semibold text-blue-800 mb-3 flex items-center">
                                     <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" />
                                     </svg>
                                     Annual Dues Rates
                                 </h4>
                                 <div class="space-y-3">
                                     <div class="bg-blue-50 rounded p-3">
                                         <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1">
                                             <span class="text-blue-700 font-medium text-sm">Community Based Clubs</span>
                                             <span class="text-blue-800 font-bold text-sm">$8.00/member/year</span>
                                         </div>
                                     </div>
                                     <div class="bg-blue-50 rounded p-3">
                                         <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-1">
                                             <span class="text-blue-700 font-medium text-sm">University Based Clubs</span>
                                             <span class="text-blue-800 font-bold text-sm">$5.00/member/year</span>
                                         </div>
                                     </div>
                                 </div>
                             </div>

                            <!-- Calculation Methods -->
                            <div class="bg-white rounded-lg p-4 border border-blue-100">
                                <h4 class="font-semibold text-blue-800 mb-3 flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                    </svg>
                                    Calculation Methods
                                </h4>
                                <div class="space-y-3 text-sm text-blue-700">
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mr-3 mt-2"></div>
                                        <div>
                                            <span class="font-semibold">Active Members (as on 1st Jan):</span> Pay complete annual dues for the entire year (Upcoming 12 months - Jan to Dec)
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mr-3 mt-2"></div>
                                        <div>
                                            <span class="font-semibold">Members Joining/Leaving in the middle of the year:</span> Dues are prorated based on membership duration
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mr-3 mt-2"></div>
                                        <div>
                                            <span class="font-semibold">Prorata Formula:</span> (Annual Dues  12)  Number of Months
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Proration & Important Dates -->
                <div class="group">
                    <div class="block bg-gradient-to-br from-green-50 to-emerald-50 p-8 rounded-xl border border-green-200 hover:border-green-300 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 h-full">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <h3 class="text-xl font-bold text-green-800 mb-3">Proration & Important Dates</h3>
                            <p class="text-green-600 mb-6">How join and leave dates affect dues calculation and key principles</p>
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Proration Principles -->
                            <div class="bg-white rounded-lg p-4 border border-green-100">
                                <h4 class="font-semibold text-green-800 mb-3 flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    Proration Principles
                                </h4>
                                <div class="space-y-3 text-sm text-green-700">
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2"></div>
                                        <div>
                                            <span class="font-semibold">Monthly Basis:</span> Dues are calculated on a monthly basis for fair distribution
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2"></div>
                                        <div>
                                            <span class="font-semibold">Join Date Rules:</span> Membership starts from the month of joining (or next month if the date of joining is after 1st of the month)
                                        </div>
                                    </div>
                                                                         <div class="flex items-start">
                                         <div class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2"></div>
                                         <div>
                                             <span class="font-semibold">Leave Date Rules:</span> Membership ends at the month of leaving
                                         </div>
                                     </div>
                                </div>
                            </div>

                            <!-- Important Dates -->
                            <div class="bg-white rounded-lg p-4 border border-green-100">
                                <h4 class="font-semibold text-green-800 mb-3 flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                                    </svg>
                                    Key Dates & Considerations
                                </h4>
                                <div class="space-y-3 text-sm text-green-700">
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2"></div>
                                        <div>
                                            <span class="font-semibold">Join Date:</span> Determines when membership begins and proration starts
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2"></div>
                                        <div>
                                            <span class="font-semibold">Leave Date:</span> Determines when membership ends and proration stops
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2"></div>
                                        <div>
                                            <span class="font-semibold">Invoice Year:</span> The year for which dues are being calculated (Upcoming 12 months - Jan to Dec).
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Similar Tools Section -->
        <section class="mt-16 mb-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Similar Tools & Initiatives</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto">Explore other interactive tools and resources from Rotaract South Asia MDIO</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
                <!-- Rotaract Buddy -->
                <div class="group">
                    <a href="https://buddy.rsamdio.org/" target="_blank" rel="noopener noreferrer" 
                       class="block bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 hover:border-blue-300 transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
                        <div class="text-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-blue-800 mb-2">Rotaract Buddy</h3>
                            <p class="text-sm text-blue-600 mb-3">AI-powered chatbot for all your Rotary & Rotaract questions</p>
                            <div class="flex items-center justify-center text-blue-500 group-hover:text-blue-600 transition-colors duration-300">
                                <span class="text-sm font-medium">View Resource</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1 group-hover:translate-x-1 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                </svg>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- NAVIGATE -->
                <div class="group">
                    <a href="https://navigate.rsamdio.org/" target="_blank" rel="noopener noreferrer" 
                       class="block bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-xl border border-green-200 hover:border-green-300 transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
                        <div class="text-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-green-800 mb-2">NAVIGATE</h3>
                            <p class="text-sm text-green-600 mb-3">Navigate your Rotaract journey with guided pathways</p>
                            <div class="flex items-center justify-center text-green-500 group-hover:text-green-600 transition-colors duration-300">
                                <span class="text-sm font-medium">View Resource</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1 group-hover:translate-x-1 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                </svg>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Publications Hub -->
                <div class="group">
                    <a href="https://connect.rsamdio.org/publications" target="_blank" rel="noopener noreferrer" 
                       class="block bg-gradient-to-br from-purple-50 to-violet-50 p-6 rounded-xl border border-purple-200 hover:border-purple-300 transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
                        <div class="text-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-purple-800 mb-2">Publications Hub</h3>
                            <p class="text-sm text-purple-600 mb-3">Access the District Publications from across South Asia</p>
                            <div class="flex items-center justify-center text-purple-500 group-hover:text-purple-600 transition-colors duration-300">
                                <span class="text-sm font-medium">View Resource</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1 group-hover:translate-x-1 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                </svg>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Rotaract News Entry Submission -->
                <div class="group">
                    <a href="https://connect.rsamdio.org/rotaractnews" target="_blank" rel="noopener noreferrer" 
                       class="block bg-gradient-to-br from-orange-50 to-red-50 p-6 rounded-xl border border-orange-200 hover:border-orange-300 transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
                        <div class="text-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-orange-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-orange-800 mb-2">News Submission</h3>
                            <p class="text-sm text-orange-600 mb-3">Submit your updates for the official Rotaract News Magazine</p>
                            <div class="flex items-center justify-center text-orange-500 group-hover:text-orange-600 transition-colors duration-300">
                                <span class="text-sm font-medium">View Resource</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1 group-hover:translate-x-1 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                </svg>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </section>



        <footer class="mt-12 py-6 bg-gradient-to-br from-gray-25 to-gray-50 border-t border-gray-100">
            <div class="max-w-5xl mx-auto px-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-6">
                    <!-- Copyright & Organization -->
                    <div class="text-center md:text-left">
                        <h4 class="text-sm font-medium text-gray-500 mb-2">Rotaract South Asia MDIO</h4>
                        <p class="text-xs text-gray-400"> <span id="current-year"></span> All rights reserved.</p>
                    </div>

                    <!-- Contact Information -->
                    <div class="text-center">
                        <h4 class="text-sm font-medium text-gray-500 mb-2">Contact</h4>
                        <p class="text-xs text-grey-400 mb-1">PDRR Arun Teja Godavarthi<br>rotaract3191drr@gmail.com</p>
                    </div>

                    <!-- Disclaimer -->
                    <div class="text-center md:text-right">
                        <h4 class="text-sm font-medium text-gray-500 mb-2">Disclaimer</h4>
                        <p class="text-xs text-gray-400">All calculations are indicative estimates. Actual figures may vary based on various factors.</p>
                    </div>
                </div>

                <!-- Bottom Bar -->
                <div class="border-t border-gray-200 pt-4">
                    <div class="flex flex-col sm:flex-row justify-between items-center space-y-2 sm:space-y-0">
                        <p class="text-xs text-gray-400 text-center sm:text-left">This tool is designed to help Rotaractors estimate their Club Invoice calculations efficiently and accurately.</p>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-xs text-gray-400">Powered by</span>
                                <a href="https://rtr.zeospec.com/" target="_blank" rel="noopener noreferrer" class="text-xs font-medium text-gray-500 hover:text-gray-600 transition-colors">ZeoSpec</a>
                            </div>
                            <div class="flex items-center space-x-3">
                                <a href="terms.html" class="text-xs text-gray-400 hover:text-gray-600 transition-colors">Terms</a>
                                <span class="text-xs text-gray-400"></span>
                                <a href="privacy.html" class="text-xs text-gray-400 hover:text-gray-600 transition-colors">Privacy</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>

    </div>

    <script>
                    // requestIdleCallback - Now provided by app.js
        
        document.addEventListener('DOMContentLoaded', () => {
            // Hide loading overlay
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('active');
            }
            const addMemberForm = document.getElementById('add-member-form');
            const memberNameInput = document.getElementById('member-name');
            const memberTypeInput = document.getElementById('member-type');
            const joinDateInput = document.getElementById('join-date');
            const leaveDateInput = document.getElementById('leave-date');
            const memberRosterBody = document.getElementById('member-roster-body');
            const totalInvoiceAmountEl = document.getElementById('total-invoice-amount');
            const resetButton = document.getElementById('reset-button');
            const invoiceYearSelect = document.getElementById('invoice-year-select');
            const invoiceDateDisplay = document.getElementById('invoice-date-display');
            const currentYearSpan = document.getElementById('current-year');
            const taxPercentageInput = document.getElementById('tax-percentage');
            const baseInvoiceAmountEl = document.getElementById('base-invoice-amount');
            const taxBreakdownEl = document.getElementById('tax-breakdown');

            // Bulk upload elements
            const fileUploadArea = document.getElementById('file-upload-area');
            const fileInput = document.getElementById('file-input');
            const browseButton = document.getElementById('browse-button');
            const uploadPreview = document.getElementById('upload-preview');
            const previewContent = document.getElementById('preview-content');
            const confirmUpload = document.getElementById('confirm-upload');
            const cancelUpload = document.getElementById('cancel-upload');
            const downloadTemplate = document.getElementById('download-template');

            // Load functions from app.js
            const { 
                downloadCSVTemplate, 
                handleFileUpload, 
                addBulkMembers, 
                resetBulkUpload,
                updatePagination, 
                goToPage, 
                goToPreviousPage, 
                goToNextPage, 
                changePageSize,
                populateYearSelector,
                updateInvoiceDateDisplay,
                editMember,
                saveMember,
                cancelEdit,
                finishEditing,
                resetCalculator,
                addMember,
                updateTotal,
                recalculateAllDues,
                showSuccessMessage,
                showErrorMessage,
                showFileUploadError,
                debouncedUpdateTotal,
                formValidator
            } = window.appFunctions || {};

            // Safety check - ensure app.js has loaded
            if (!window.appFunctions) {
                // app.js functions not available. Please refresh the page.
                // Show user-friendly error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-feedback fade-in';
                errorDiv.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span>Application failed to load properly. Please refresh the page.</span>
                `;
                document.body.insertBefore(errorDiv, document.body.firstChild);
            }

            // Wait for app.js to load if not already available
            function waitForAppFunctions() {
                return new Promise((resolve) => {
                    if (window.appFunctions) {
                        resolve(window.appFunctions);
                    } else {
                        const checkInterval = setInterval(() => {
                            if (window.appFunctions) {
                                clearInterval(checkInterval);
                                resolve(window.appFunctions);
                            }
                        }, 100);
                        
                        // Timeout after 5 seconds
                        setTimeout(() => {
                            clearInterval(checkInterval);
                            resolve(null);
                        }, 5000);
                    }
                });
            }

            let parsedMembers = [];

            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            const todayFormatted = `${yyyy}-${mm}-${dd}`;
            joinDateInput.value = todayFormatted;
            currentYearSpan.textContent = yyyy;

            let lastSelectedClubBase = memberTypeInput.value;
            let lastSelectedJoinDate = joinDateInput.value;

            // Pagination variables
            let currentPage = 1;
            let pageSize = 10;
            // allMemberRows is now managed by app.js

            // Functions will be loaded from app.js after DOM is ready

            // debounce function - Now provided by app.js
            
            // updateTotal function - Now provided by app.js
            
            // Debounced version for input events - Now provided by app.js
            // const debouncedUpdateTotal = debounce(updateTotal, 300);
            
            // recalculateAllDues function - Now provided by app.js

            // Unified Form Validation System - Now provided by app.js
            // class FormValidator { ... } - Removed

            // Form validator - Now provided by app.js
            // const formValidator = new FormValidator();

            // showFieldError function - Now provided by app.js
            
            // Message display functions - Now provided by app.js
            // Removed: showSuccessMessage, showErrorMessage, showFileUploadError
            
            // addMember function - Now provided by app.js

            // Member management functions - Now provided by app.js
            // Removed: editMember, saveMember, cancelEdit, finishEditing, resetCalculator



            // finishEditing and resetCalculator functions - Now provided by app.js

            // Pagination Functions - Now handled by app.js
            // Removed: updatePagination, displayCurrentPage, goToPage, goToPreviousPage, goToNextPage, changePageSize

            addMemberForm.addEventListener('submit', async (e) => {
                e.preventDefault(); // Prevent default HTML5 validation
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.addMember) {
                    appFunctions.addMember(e);
                }
            });
            
            resetButton.addEventListener('click', async () => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.resetCalculator) {
                    appFunctions.resetCalculator();
                }
            });
            
            invoiceYearSelect.addEventListener('change', async () => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.recalculateAllDues) {
                    appFunctions.recalculateAllDues();
                }
            });
            
            taxPercentageInput.addEventListener('input', async () => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.debouncedUpdateTotal) {
                    appFunctions.debouncedUpdateTotal();
                }
            });

            // Currency rate input event listener
            const currencyRateInput = document.getElementById('currency-rate');
            if (currencyRateInput) {
                currencyRateInput.addEventListener('input', async () => {
                    const appFunctions = await waitForAppFunctions();
                    if (appFunctions && appFunctions.debouncedUpdateTotal) {
                        appFunctions.debouncedUpdateTotal();
                    }
                });
            }

            // Bulk upload event listeners
            browseButton.addEventListener('click', () => fileInput.click());
            
            fileInput.addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (file) {
                    const appFunctions = await waitForAppFunctions();
                    if (appFunctions && appFunctions.handleFileUpload) {
                        appFunctions.handleFileUpload(file);
                    }
                }
            });

            // Drag and drop functionality
            fileUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileUploadArea.classList.add('dragover');
            });

            fileUploadArea.addEventListener('dragleave', () => {
                fileUploadArea.classList.remove('dragover');
            });

            fileUploadArea.addEventListener('drop', async (e) => {
                e.preventDefault();
                fileUploadArea.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file) {
                    const appFunctions = await waitForAppFunctions();
                    if (appFunctions && appFunctions.handleFileUpload) {
                        appFunctions.handleFileUpload(file);
                    }
                }
            });

            confirmUpload.addEventListener('click', async () => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.addBulkMembers) {
                    appFunctions.addBulkMembers();
                }
            });
            
            cancelUpload.addEventListener('click', async () => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.resetBulkUpload) {
                    appFunctions.resetBulkUpload();
                }
            });
            
            downloadTemplate.addEventListener('click', async () => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.downloadCSVTemplate) {
                    appFunctions.downloadCSVTemplate();
                }
            });

            // Pagination event listeners
            const pageSizeSelect = document.getElementById('page-size-select');
            const prevPageBtn = document.getElementById('prev-page');
            const nextPageBtn = document.getElementById('next-page');
            
            pageSizeSelect.addEventListener('change', async (e) => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.changePageSize) {
                    appFunctions.changePageSize(e.target.value);
                }
            });
            
            prevPageBtn.addEventListener('click', async () => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.goToPreviousPage) {
                    appFunctions.goToPreviousPage();
                }
            });
            
            nextPageBtn.addEventListener('click', async () => {
                const appFunctions = await waitForAppFunctions();
                if (appFunctions && appFunctions.goToNextPage) {
                    appFunctions.goToNextPage();
                }
            });

            // Mobile pagination event listeners
            const pageSizeSelectMobile = document.getElementById('page-size-select-mobile');
            const prevPageBtnMobile = document.getElementById('prev-page-mobile');
            const nextPageBtnMobile = document.getElementById('next-page-mobile');
            
            if (pageSizeSelectMobile) {
                pageSizeSelectMobile.addEventListener('change', async (e) => {
                    const appFunctions = await waitForAppFunctions();
                    if (appFunctions && appFunctions.changePageSize) {
                        appFunctions.changePageSize(e.target.value);
                    }
                });
            }
            
            if (prevPageBtnMobile) {
                prevPageBtnMobile.addEventListener('click', async () => {
                    const appFunctions = await waitForAppFunctions();
                    if (appFunctions && appFunctions.goToPreviousPage) {
                        appFunctions.goToPreviousPage();
                    }
                });
            }
            
            if (nextPageBtnMobile) {
                nextPageBtnMobile.addEventListener('click', async () => {
                    const appFunctions = await waitForAppFunctions();
                    if (appFunctions && appFunctions.goToNextPage) {
                        appFunctions.goToNextPage();
                    }
                });
            }

            // Initialize the application - Now handled by initializeApplication()
            
            // Initialize with proper function loading
            async function initializeApplication() {
                const appFunctions = await waitForAppFunctions();
                if (!appFunctions) {
                    // Failed to load app.js functions
                    return;
                }
                
                // Re-destructure functions after they're confirmed to be available
                const {
                    initializeApp: initializeAppFn,
                    updatePagination: updatePaginationFn
                } = appFunctions;
                
                // Initialize the application (this includes populateYearSelector)
                if (initializeAppFn) {
    
                    initializeAppFn();
                }
                
                // Update pagination
                if (updatePaginationFn) updatePaginationFn();
            }
            
            // Start initialization
            initializeApplication();
            
            // Initialize Firebase authentication directly
            initializeFirebaseAuthDirectly();
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + Enter to add member
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    const activeElement = document.activeElement;
                    if (activeElement && activeElement.closest('#add-member-form')) {
                        addMemberForm.dispatchEvent(new Event('submit'));
                    }
                }
                
                // Escape to close modals/overlays
                if (e.key === 'Escape') {
                    const loadingOverlay = document.getElementById('loading-overlay');
                    if (loadingOverlay && loadingOverlay.classList.contains('active')) {
                        loadingOverlay.classList.remove('active');
                    }
                }
            });
            
            // Add form field validation on blur using the new system
            [memberNameInput, memberTypeInput, joinDateInput, leaveDateInput].forEach(input => {
                if (input) {
                    input.addEventListener('blur', async () => {
                        // Validate only the specific field that lost focus
                        const appFunctions = await waitForAppFunctions();
                        if (appFunctions && appFunctions.formValidator) {
                            appFunctions.formValidator.validateField(input.id);
                        }
                    });
                    
                    // Add real-time validation on input for better UX
                    input.addEventListener('input', async () => {
                        // Clear error state when user starts typing/selecting
                        const appFunctions = await waitForAppFunctions();
                        if (appFunctions && appFunctions.formValidator && appFunctions.formValidator.errors.has(input.id)) {
                            appFunctions.formValidator.clearFieldError(input.id);
                        }
                    });
                }
            });
            
            // Performance optimization: Preload critical resources
            // requestIdleCallback - Now provided by app.js

            // PDF Generation Functionality using Web Worker
            const downloadPdfBtn = document.getElementById('downloadPdfBtn');
            const pdfStatus = document.getElementById('pdfStatus');
            let pdfWorker = null;

            downloadPdfBtn.addEventListener('click', function(event) {
                // Prevent default form submission behavior
                event.preventDefault();
                event.stopPropagation();
                
                // Log current member count for debugging
                const memberCount = document.getElementById('member-roster-body').querySelectorAll('tr').length;

                // Log user activity if authenticated
                if (window.isAuthenticated && window.currentUser && window.appFunctions && window.appFunctions.logUserActivity) {
                    window.appFunctions.logUserActivity(window.currentUser.uid, 'generate_pdf');
                }
                
                generatePDFReport();
            });

            function generatePDFReport() {
                // Show loading overlay for better UX
                const loadingOverlay = document.getElementById('loading-overlay');
                if (loadingOverlay) {
                    loadingOverlay.classList.add('active');
                }
                
                // Show loading status
                downloadPdfBtn.disabled = true;
                pdfStatus.classList.remove('hidden');
                
                // Use setTimeout to allow UI to update before starting heavy processing
                setTimeout(() => {
                    generatePDFReportAsync();
                }, 100);
            }

            async function generatePDFReportAsync() {
                try {
                    // Update loading message for better UX
                    const loadingMessage = document.getElementById('loading-message');
                    const progressBar = document.getElementById('loading-progress-bar');
                    const step1 = document.getElementById('step-1');
                    const step2 = document.getElementById('step-2');
                    const step3 = document.getElementById('step-3');
                    const step4 = document.getElementById('step-4');
                    
                    if (loadingMessage) {
                        loadingMessage.textContent = 'Preparing PDF report...';
                    }
                    if (progressBar) {
                        progressBar.style.width = '10%';
                    }
                    
                    // Get summary data from the existing calculations
                    const baseAmount = parseFloat(document.getElementById('base-invoice-amount').textContent.replace(/[^0-9.-]+/g, '')) || 0;
                    const taxAmount = parseFloat(document.getElementById('tax-breakdown').textContent.replace(/[^0-9.-]+/g, '')) || 0;
                    const totalAmount = parseFloat(document.getElementById('total-invoice-amount').textContent.replace(/[^0-9.-]+/g, '')) || 0;
                    const totalMembers = document.getElementById('total-members').textContent || '0';
                    const totalProratedMonths = document.getElementById('total-prorated-months').textContent || '0';
                    const taxPercentage = parseFloat(document.getElementById('tax-percentage').value) || 0;
                    const invoiceYear = document.getElementById('invoice-year-select').value;

                    // Extract Full Year and Prorated amounts from the base amount breakdown
                    let totalFullYearAmount = 0;
                    let totalProratedAmount = 0;
                    
                    // Use the existing calculated values from member roster cells
                    const memberRowsForSummary = document.getElementById('member-roster-body').querySelectorAll('tr');
                    memberRowsForSummary.forEach(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 7) {
                            const estBaseDue = cells[4].textContent.trim();
                            const dueMatch = estBaseDue.match(/\$([0-9,]+\.?[0-9]*) \+ \$([0-9,]+\.?[0-9]*) = \$([0-9,]+\.?[0-9]*)/);
                            if (dueMatch) {
                                const fullYearAmount = parseFloat(dueMatch[1].replace(/,/g, '')) || 0;
                                const proratedAmount = parseFloat(dueMatch[2].replace(/,/g, '')) || 0;
                                
                                totalFullYearAmount += fullYearAmount;
                                totalProratedAmount += proratedAmount;
                            }
                        }
                    });

                    // Get currency rate for calculations
                    const currencyRate = parseFloat(document.getElementById('currency-rate')?.value) || 87;
                    
                    // Prepare member data for PDF
                    const memberData = [];
                    const memberRows = document.getElementById('member-roster-body').querySelectorAll('tr');
                    
                    memberRows.forEach(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 9) {
                            const name = cells[0].textContent.trim();
                            const joinDate = cells[1].textContent.trim();
                            const leaveDate = cells[2].textContent.trim() || 'Active';
                            const clubBase = cells[3].textContent.trim();
                            const estBaseDue = cells[4].textContent.trim();
                            const estLocalDue = cells[5].textContent.trim();
                            
                            // Format the "Est. Base + Tax (Local)" column for PDF
                            let formattedEstLocalWithTax = cells[6].textContent.trim();
                            
                            // Extract the total amount and tax amount from the existing format
                            // Current format: "696.00 + 125.28 = 821.28"
                            const taxMatch = formattedEstLocalWithTax.match(/(\d+\.?\d*) \+ (\d+\.?\d*) = (\d+\.?\d*)/);
                            if (taxMatch) {
                                const baseAmount = parseFloat(taxMatch[1]);
                                const taxAmount = parseFloat(taxMatch[2]);
                                const totalAmount = parseFloat(taxMatch[3]);
                                
                                // Format as requested: "Total with Tax\n(Tax: total tax amount)"
                                formattedEstLocalWithTax = `${totalAmount.toFixed(2)}\n(Tax: ${taxAmount.toFixed(2)})`;
                            }
                            
                            const activeMember = cells[7].textContent.trim();
                            const proratedMonths = parseInt(cells[8].textContent.trim()) || 0;
                            
                            memberData.push([name, joinDate, leaveDate, clubBase, estBaseDue, estLocalDue, formattedEstLocalWithTax, activeMember, proratedMonths]);
                        }
                    });
                    
                    // Add totals row
                    const formattedTotalFullYear = totalFullYearAmount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    const formattedTotalProrated = totalProratedAmount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    const formattedTotalEstDue = (totalFullYearAmount + totalProratedAmount).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    
                    const totalEstDueDisplay = `$${formattedTotalFullYear} + $${formattedTotalProrated} = $${formattedTotalEstDue}`;
                    
                    // Calculate local currency totals for the totals row
                    const totalFullYearLocal = Math.round(totalFullYearAmount * currencyRate * 100) / 100;
                    const totalProratedLocal = Math.round(totalProratedAmount * currencyRate * 100) / 100;
                    const totalLocalEstDue = totalFullYearLocal + totalProratedLocal;
                    
                    const formattedTotalFullYearLocal = totalFullYearLocal.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    const formattedTotalProratedLocal = totalProratedLocal.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    const formattedTotalLocalEstDue = totalLocalEstDue.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    
                    const totalLocalEstDueDisplay = `${formattedTotalFullYearLocal} + ${formattedTotalProratedLocal} = ${formattedTotalLocalEstDue}`;
                    
                    // Calculate local amounts with separate tax calculation for totals
                    const fullYearLocalAmount = Math.round(totalFullYearAmount * currencyRate * 100) / 100;
                    const proratedLocalAmount = Math.round(totalProratedAmount * currencyRate * 100) / 100;
                    const baseLocalAmount = fullYearLocalAmount + proratedLocalAmount;
                    
                    // Calculate local currency tax separately on annual and prorated dues
                    const taxOnLocalAnnualDues = Math.round((fullYearLocalAmount * taxPercentage) / 100 * 100) / 100;
                    const taxOnLocalProratedDues = Math.round((proratedLocalAmount * taxPercentage) / 100 * 100) / 100;
                    const taxLocalAmount = taxOnLocalAnnualDues + taxOnLocalProratedDues;
                    const totalLocalAmount = baseLocalAmount + taxLocalAmount;
                    
                    // Format the totals row "Est. Base + Tax (Local)" column
                    const formattedTotalLocalWithTax = `${totalLocalAmount.toFixed(2)}\n(Tax: ${taxLocalAmount.toFixed(2)})`;
                    
                    memberData.push([
                        'TOTAL',
                        '',
                        '',
                        '',
                        totalEstDueDisplay,
                        totalLocalEstDueDisplay,
                        formattedTotalLocalWithTax,
                        totalMembers,
                        totalProratedMonths
                    ]);

                    // Update loading progress
                    if (loadingMessage) {
                        loadingMessage.textContent = 'Generating PDF with Web Worker...';
                    }
                    if (progressBar) {
                        progressBar.style.width = '50%';
                    }
                    if (step1) {
                        step1.classList.remove('active');
                        step1.classList.add('completed');
                    }
                    if (step2) {
                        step2.classList.add('active');
                    }



                    // Prepare data for Web Worker
                    const pdfData = {
                        memberData: memberData,
                        summaryData: {
                            baseAmount: baseAmount,
                            taxAmount: taxAmount,
                            totalWithTax: totalAmount,
                            totalFullYearAmount: totalFullYearAmount,
                            totalProratedAmount: totalProratedAmount,
                            // Local currency amounts
                            baseLocalAmount: baseLocalAmount,
                            taxLocalAmount: taxLocalAmount,
                            totalLocalAmount: totalLocalAmount,
                            fullYearLocalAmount: fullYearLocalAmount,
                            proratedLocalAmount: proratedLocalAmount
                        },
                        invoiceYear: invoiceYear,
                        taxPercentage: taxPercentage,
                        currencyRate: currencyRate,
                        totalMembers: totalMembers,
                        totalProratedMonths: totalProratedMonths
                    };

                    // Create Web Worker for PDF generation
                    if (!pdfWorker) {
                        try {
                            pdfWorker = new Worker('pdf-worker.js');
                            
                            // Handle Web Worker messages
                            pdfWorker.onmessage = function(e) {
                                const { type, blob, fileName, error } = e.data;
                                
                                if (type === 'pdfGenerated' && blob) {
                                    // Create download link and trigger download
                                    const url = URL.createObjectURL(blob);
                                    const a = document.createElement('a');
                                    a.href = url;
                                    a.download = fileName;
                                    document.body.appendChild(a);
                                    a.click();
                                    document.body.removeChild(a);
                                    URL.revokeObjectURL(url);
                                    
                                    // Log invoice summary to Firestore if available
                                    try {
                                        if (window.isAuthenticated && window.currentUser && window.appFunctions && window.appFunctions.logInvoiceSummary) {
                                            const summaryForLog = {
                                                invoiceYear: pdfData.invoiceYear,
                                                taxPercentage: pdfData.taxPercentage,
                                                currencyRate: pdfData.currencyRate,
                                                totalMembers: Number(pdfData.totalMembers) || 0,
                                                totalProratedMonths: Number(pdfData.totalProratedMonths) || 0,
                                                baseAmount: pdfData.summaryData?.baseAmount ?? null,
                                                taxAmount: pdfData.summaryData?.taxAmount ?? null,
                                                totalWithTax: pdfData.summaryData?.totalWithTax ?? null,
                                                totalFullYearAmount: pdfData.summaryData?.totalFullYearAmount ?? null,
                                                totalProratedAmount: pdfData.summaryData?.totalProratedAmount ?? null,
                                                baseLocalAmount: pdfData.summaryData?.baseLocalAmount ?? null,
                                                taxLocalAmount: pdfData.summaryData?.taxLocalAmount ?? null,
                                                totalLocalAmount: pdfData.summaryData?.totalLocalAmount ?? null,
                                                fullYearLocalAmount: pdfData.summaryData?.fullYearLocalAmount ?? null,
                                                proratedLocalAmount: pdfData.summaryData?.proratedLocalAmount ?? null
                                            };
                                            window.appFunctions.logInvoiceSummary(window.currentUser.uid, summaryForLog);
                                        }
                                    } catch (e) {
                                        // Do not block UI on logging errors
                                        // Silent error handling for production
                                    }

                                    // Complete progress
                                    if (progressBar) {
                                        progressBar.style.width = '100%';
                                    }
                                    if (step4) {
                                        step4.classList.remove('active');
                                        step4.classList.add('completed');
                                    }
                                    if (loadingMessage) {
                                        loadingMessage.textContent = 'Detailed Report generated successfully!';
                                    }

                                    // Hide loading status and overlay after a brief delay
                                    setTimeout(() => {
                                        downloadPdfBtn.disabled = false;
                                        pdfStatus.classList.add('hidden');
                                        if (loadingOverlay) {
                                            loadingOverlay.classList.remove('active');
                                        }
                                    }, 1000);
                                    
                                } else if (type === 'error') {
                                    // PDF generation error
                                    
                                    // Hide loading status and overlay
                                    downloadPdfBtn.disabled = false;
                                    pdfStatus.classList.add('hidden');
                                    if (loadingOverlay) {
                                        loadingOverlay.classList.remove('active');
                                    }
                                    
                                    // Show error message
                                    alert('Error generating Detailed Report. Please try again.');
                                }
                            };
                            
                            // Handle Web Worker errors
                            pdfWorker.onerror = function(error) {
                                // Web Worker error
                                
                                // Hide loading status and overlay
                                downloadPdfBtn.disabled = false;
                                pdfStatus.classList.add('hidden');
                                if (loadingOverlay) {
                                    loadingOverlay.classList.remove('active');
                                }
                                
                                // Show error message
                                alert('Error generating Detailed Report. Please try again.');
                            };
                                                    } catch (workerError) {
                                // Failed to create Web Worker
                            
                            // Hide loading status and overlay
                            downloadPdfBtn.disabled = false;
                            pdfStatus.classList.add('hidden');
                            if (loadingOverlay) {
                                loadingOverlay.classList.remove('active');
                            }
                            
                            // Show error message
                            alert('PDF generation is not available in this browser. Please try a different browser.');
                            return;
                        }
                    }

                    // Update loading progress
                    if (loadingMessage) {
                        loadingMessage.textContent = 'Processing PDF generation...';
                    }
                    if (progressBar) {
                        progressBar.style.width = '70%';
                    }
                    if (step2) {
                        step2.classList.remove('active');
                        step2.classList.add('completed');
                    }
                    if (step3) {
                        step3.classList.add('active');
                    }

                    // Send data to Web Worker
                    pdfWorker.postMessage({ type: 'generatePDF', data: pdfData });

                    // Update final progress
                    if (loadingMessage) {
                        loadingMessage.textContent = 'Finalizing PDF...';
                    }
                    if (progressBar) {
                        progressBar.style.width = '90%';
                    }
                    if (step3) {
                        step3.classList.remove('active');
                        step3.classList.add('completed');
                    }
                    if (step4) {
                        step4.classList.add('active');
                    }

                                        } catch (error) {
                            // Error preparing PDF data
                    
                    // Hide loading status and overlay
                    downloadPdfBtn.disabled = false;
                    pdfStatus.classList.add('hidden');
                    if (loadingOverlay) {
                        loadingOverlay.classList.remove('active');
                    }
                    
                    // Show error message
                    alert('Error preparing PDF data. Please try again.');
                }
            }
            
            // Lightweight Instructions Modal
            const instructionsModal = document.getElementById('instructions-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const gotItBtn = document.getElementById('got-it-btn');

            function showModal() {
                instructionsModal.classList.add('active');
                document.body.classList.add('modal-open');
                document.body.style.overflow = 'hidden';
            }

            function hideModal() {
                instructionsModal.classList.remove('active');
                document.body.classList.remove('modal-open');
                document.body.style.overflow = '';
            }

            // Simple event listeners
            closeModalBtn.addEventListener('click', hideModal);
            gotItBtn.addEventListener('click', hideModal);
            
            // Close on outside click
            instructionsModal.addEventListener('click', (e) => {
                if (e.target === instructionsModal) hideModal();
            });
            
            // Close on Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && instructionsModal.classList.contains('active')) {
                    hideModal();
                }
            });

            // Don't show modal immediately - wait for Firebase auth check
            // We'll show it after Firebase determines the auth state
            
            // Initialize Firebase authentication directly
            function initializeFirebaseAuthDirectly() {
                // Wait for Firebase to be available
                const checkFirebase = () => {
                    if (window.firebaseAuth && window.firebaseProvider && window.firebaseSignIn && window.firebaseSignOut && window.firebaseOnAuthStateChanged) {

                        
                        // Listen for auth state changes
                        window.firebaseOnAuthStateChanged(window.firebaseAuth, (user) => {
                            if (user) {
                                // User is signed in
                                // Set global variables for app.js
                                window.currentUser = user;
                                window.isAuthenticated = true;
                                updateLoginUI(user);
                                
                                // Immediately save user's basic information
                                if (window.appFunctions && window.appFunctions.saveUserBasicInfo) {
                                    window.appFunctions.saveUserBasicInfo(user);
                                }
                                
                                // Log user sign in if app functions are available
                                if (window.appFunctions && window.appFunctions.logUserActivity) {
                                    window.appFunctions.logUserActivity(user.uid, 'sign_in');
                                }
                                
                                // Load user data if app functions are available
                                if (window.appFunctions && window.appFunctions.loadUserData) {
                                    window.appFunctions.loadUserData(user.uid);
                                }
                            } else {
                                // User is signed out
                                // Set global variables for app.js
                                window.currentUser = null;
                                window.isAuthenticated = false;
                                updateLoginUI(null);
                                
                                // Show instructions modal for non-authenticated users
                                // Only show if no other modal is currently active
                                if (!document.querySelector('.modal-overlay.active')) {
                                    showModal();
                                }
                            }
                        });
                        
                        // Add event listeners for login/logout buttons
                        const loginState = document.getElementById('login-state');
                        const logoutButton = document.getElementById('logout-button');
                        
                        if (loginState) {
                            loginState.addEventListener('click', async () => {
                                try {
                                    
                                    // Show loading state with enhanced feedback
                                    loginState.classList.add('hidden');
                                    const loadingState = document.getElementById('loading-state');
                                    loadingState.classList.remove('hidden');
                                    loadingState.innerHTML = `
                                        <div class="animate-spin rounded-full h-4 w-4 border-2 border-gray-300 border-t-blue-600 mr-2"></div>
                                        <span class="text-sm font-medium">Signing in with Google...</span>
                                    `;
                                    
                                    await window.firebaseSignIn(window.firebaseAuth, window.firebaseProvider);
                                    
                                    // Show success feedback
                                    showSignInSuccess();
                                    
                                } catch (error) {
                                    // Hide loading state and show login state again
                                    document.getElementById('loading-state').classList.add('hidden');
                                    loginState.classList.remove('hidden');
                                    
                                    // Show error notification
                                    showSignInError();
                                }
                            });
                        } else {
                            // Sign in state not found
                        }
                        
                        // Logout button is now handled in setupProfileDropdown()
                        // No need to add event listener here
                        
                    } else {
                        // Firebase not yet available, retrying...
                        setTimeout(checkFirebase, 100);
                    }
                };
                
                checkFirebase();
            }
            
            function updateLoginUI(user) {
                const loginState = document.getElementById('login-state');
                const userState = document.getElementById('user-state');
                const loadingState = document.getElementById('loading-state');
                const userAvatar = document.getElementById('user-avatar');
                const dropdownAvatar = document.getElementById('dropdown-avatar');
                const dropdownName = document.getElementById('dropdown-name');
                const dropdownEmail = document.getElementById('dropdown-email');
                const profileTrigger = document.getElementById('profile-trigger');
                const profileDropdown = document.getElementById('profile-dropdown');
                

                
                // Ensure save button exists and manage its visibility
                let saveButton = document.getElementById('save-button');
                if (!saveButton) {
                    // Save button not found, calling setupManualSave...
                    // Call the app.js function if available
                    if (window.appFunctions && window.appFunctions.setupManualSave) {
                        window.appFunctions.setupManualSave();
                    } else {
                        // Fallback: create the button directly
                        const resetButton = document.getElementById('reset-button');
                        if (resetButton) {
                            // Creating save button directly...
                            saveButton = document.createElement('button');
                            saveButton.id = 'save-button';
                            saveButton.type = 'button';
                            saveButton.className = 'btn text-sm px-4 sm:px-6 py-3 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200 whitespace-nowrap';
                            saveButton.style.backgroundColor = '#10b981'; // Green background
                            saveButton.style.color = 'white'; // White text
                            saveButton.style.border = 'none';
                            saveButton.style.borderRadius = '0.375rem';
                            saveButton.style.fontWeight = '500';
                            saveButton.style.cursor = 'pointer';
                            
                            saveButton.style.display = 'inline-flex'; // Always visible now
                            
                            // Set initial state
                            if (window.appFunctions && window.appFunctions.updateSaveButtonState) {
                                window.appFunctions.updateSaveButtonState(saveButton);
                            } else {
                                // Fallback: set basic save functionality
                                saveButton.innerHTML = `
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                    </svg>
                                    <span class="hidden sm:inline">Save to Cloud</span>
                                    <span class="sm:hidden">Save</span>
                                `;
                                saveButton.addEventListener('click', () => {
                                    if (window.appFunctions && window.appFunctions.handleManualSave) {
                                        window.appFunctions.handleManualSave();
                                    } else {
                                        alert('Save functionality not available. Please refresh the page.');
                                    }
                                });
                            }
                            resetButton.parentNode.appendChild(saveButton);
                        }
                    }
                    saveButton = document.getElementById('save-button');
                }
                
                if (user) {
                    // User is logged in - show user state
                    loginState.classList.add('hidden');
                    loadingState.classList.add('hidden');
                    userState.classList.remove('hidden');
                    
                    // Update user info in both profile circle and dropdown
                    const avatarSrc = user.photoURL || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDEyQzE0LjIwOTEgMTIgMTYgMTAuMjA5MSAxNiA4QzE2IDUuNzkwODYgMTQuMjA5MSA0IDEyIDRDOS43OTA4NiA0IDggNS43OTA4NiA4IDhDOCAxMC4yMDkxIDkuNzkwODYgMTIgMTIgMTJaIiBmaWxsPSIjNkI3MjgwIi8+CjxwYXRoIGQ9Ik0xMiAxNEM5LjMzIDE0IDcgMTYuMzMgNyAxOVYyMEgxN1YxOUMxNyAxNi4zMyAxNC42NyAxNCAxMiAxNFoiIGZpbGw9IiM2QjcyODAiLz4KPC9zdmc+';
                    
                    if (userAvatar) userAvatar.src = avatarSrc;
                    if (dropdownAvatar) dropdownAvatar.src = avatarSrc;
                    if (dropdownName) dropdownName.textContent = user.displayName || 'User';
                    if (dropdownEmail) dropdownEmail.textContent = user.email || '';
                    
                    // Setup dropdown functionality
                    setupProfileDropdown();
                    
                    // Ensure dropdown is properly reset for new user
                    resetDropdownState();
                    
                    // Update save button state
                    if (window.appFunctions && window.appFunctions.updateSaveButtonState) {
                        window.appFunctions.updateSaveButtonState();
                    }
                } else {
                    // User is logged out - show login state
                    userState.classList.add('hidden');
                    loadingState.classList.add('hidden');
                    loginState.classList.remove('hidden');
                    
                    // Hide dropdown if open
                    if (profileDropdown) {
                        profileDropdown.classList.add('hidden');
                        profileDropdown.classList.remove('opacity-100', 'scale-100');
                        profileDropdown.classList.add('opacity-0', 'scale-95');
                    }
                    
                    // Update save button state
                    if (window.appFunctions && window.appFunctions.updateSaveButtonState) {
                        window.appFunctions.updateSaveButtonState();
                    }
                }
            }
            
            function setupProfileDropdown() {
                const profileTrigger = document.getElementById('profile-trigger');
                const profileDropdown = document.getElementById('profile-dropdown');
                const logoutButton = document.getElementById('logout-button');
                
                if (!profileTrigger || !profileDropdown) return;
                
                // Reset dropdown state first
                profileDropdown.classList.add('hidden');
                profileDropdown.classList.remove('opacity-100', 'scale-100');
                profileDropdown.classList.add('opacity-0', 'scale-95');
                
                // Reset logout button state if it exists
                if (logoutButton) {
                    logoutButton.disabled = false;
                    logoutButton.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400 group-hover:text-red-500 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        <span class="group-hover:text-red-600 transition-colors">Sign out</span>
                    `;
                }
                
                // Remove existing event listeners to prevent duplicates
                const newProfileTrigger = profileTrigger.cloneNode(true);
                profileTrigger.parentNode.replaceChild(newProfileTrigger, profileTrigger);
                
                // Get the new elements
                const newProfileDropdown = document.getElementById('profile-dropdown');
                const newLogoutButton = document.getElementById('logout-button');
                
                // Toggle dropdown on profile click
                newProfileTrigger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isVisible = !newProfileDropdown.classList.contains('hidden');
                    
                    if (isVisible) {
                        // Hide dropdown
                        newProfileDropdown.classList.add('opacity-0', 'scale-95');
                        newProfileDropdown.classList.remove('opacity-100', 'scale-100');
                        setTimeout(() => {
                            newProfileDropdown.classList.add('hidden');
                        }, 150);
                    } else {
                        // Show dropdown
                        newProfileDropdown.classList.remove('hidden');
                        setTimeout(() => {
                            newProfileDropdown.classList.remove('opacity-0', 'scale-95');
                            newProfileDropdown.classList.add('opacity-100', 'scale-100');
                        }, 10);
                    }
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!newProfileTrigger.contains(e.target) && !newProfileDropdown.contains(e.target)) {
                        newProfileDropdown.classList.add('opacity-0', 'scale-95');
                        newProfileDropdown.classList.remove('opacity-100', 'scale-100');
                        setTimeout(() => {
                            newProfileDropdown.classList.add('hidden');
                        }, 150);
                    }
                });
                
                // Close dropdown on escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        newProfileDropdown.classList.add('opacity-0', 'scale-95');
                        newProfileDropdown.classList.remove('opacity-100', 'scale-100');
                        setTimeout(() => {
                            newProfileDropdown.classList.add('hidden');
                        }, 150);
                    }
                });
                
                // Logout button functionality
                if (newLogoutButton) {
                    // Ensure logout button is in correct state before adding event listener
                    newLogoutButton.disabled = false;
                    newLogoutButton.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400 group-hover:text-red-500 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        <span class="group-hover:text-red-600 transition-colors">Sign out</span>
                    `;
                    
                    newLogoutButton.addEventListener('click', async (e) => {
                        e.preventDefault();
                        
                        // Show loading state in dropdown
                        const originalText = newLogoutButton.innerHTML;
                        newLogoutButton.innerHTML = `
                            <div class="animate-spin rounded-full h-4 w-4 border-2 border-gray-300 border-t-red-500 mr-2"></div>
                            <span>Signing out...</span>
                        `;
                        newLogoutButton.disabled = true;
                        
                        try {
                            
                            // Close dropdown first
                            newProfileDropdown.classList.add('opacity-0', 'scale-95');
                            newProfileDropdown.classList.remove('opacity-100', 'scale-100');
                            setTimeout(() => {
                                newProfileDropdown.classList.add('hidden');
                            }, 150);
                            
                            // Show loading state in main UI
                            const userState = document.getElementById('user-state');
                            const loadingState = document.getElementById('loading-state');
                            
                            userState.classList.add('hidden');
                            loadingState.classList.remove('hidden');
                            loadingState.innerHTML = `
                                <div class="animate-spin rounded-full h-4 w-4 border-2 border-gray-300 border-t-blue-600 mr-2"></div>
                                <span class="text-sm font-medium">Signing out...</span>
                            `;
                            
                            // Set a timeout to prevent getting stuck in loading state
                            const timeoutId = setTimeout(() => {
                                // Reset button state on timeout
                                newLogoutButton.innerHTML = originalText;
                                newLogoutButton.disabled = false;
                            }, 10000); // 10 second timeout
                            
                            // Perform sign out
                            await window.firebaseSignOut(window.firebaseAuth);
                            
                            // Clear timeout since logout was successful
                            clearTimeout(timeoutId);
                            
                            // Show success feedback
                            showSignOutSuccess();
                            
                        } catch (error) {
                            
                            // Restore button state
                            newLogoutButton.innerHTML = originalText;
                            newLogoutButton.disabled = false;
                            
                            // Show error message
                            showSignOutError();
                        }
                    });
                }
            }
            
            function resetDropdownState() {
                const profileDropdown = document.getElementById('profile-dropdown');
                const logoutButton = document.getElementById('logout-button');
                
                if (profileDropdown) {
                    // Reset dropdown visibility
                    profileDropdown.classList.add('hidden');
                    profileDropdown.classList.remove('opacity-100', 'scale-100');
                    profileDropdown.classList.add('opacity-0', 'scale-95');
                }
                
                if (logoutButton) {
                    // Reset logout button state
                    logoutButton.disabled = false;
                    logoutButton.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400 group-hover:text-red-500 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        <span class="group-hover:text-red-600 transition-colors">Sign out</span>
                    `;
                }
            }
            
            // Notification functions for enhanced UX
            function showSignInSuccess() {
                const notification = document.createElement('div');
                notification.className = 'fixed top-20 right-4 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full opacity-0';
                notification.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span class="font-medium">Successfully signed in!</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Animate in
                setTimeout(() => {
                    notification.classList.remove('translate-x-full', 'opacity-0');
                    notification.classList.add('translate-x-0', 'opacity-100');
                }, 100);
                
                // Auto remove after 3 seconds
                setTimeout(() => {
                    notification.classList.add('translate-x-full', 'opacity-0');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }
            
            function showSignInError() {
                const notification = document.createElement('div');
                notification.className = 'fixed top-20 right-4 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full opacity-0';
                notification.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span class="font-medium">Sign in failed. Please try again.</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Animate in
                setTimeout(() => {
                    notification.classList.remove('translate-x-full', 'opacity-0');
                    notification.classList.add('translate-x-0', 'opacity-100');
                }, 100);
                
                // Auto remove after 4 seconds
                setTimeout(() => {
                    notification.classList.add('translate-x-full', 'opacity-0');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 4000);
            }
            
            function showSignOutSuccess() {
                const notification = document.createElement('div');
                notification.className = 'fixed top-20 right-4 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full opacity-0';
                notification.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span class="font-medium">Successfully signed out!</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Animate in
                setTimeout(() => {
                    notification.classList.remove('translate-x-full', 'opacity-0');
                    notification.classList.add('translate-x-0', 'opacity-100');
                }, 100);
                
                // Auto remove after 3 seconds
                setTimeout(() => {
                    notification.classList.add('translate-x-full', 'opacity-0');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }
            
            function showSignOutError() {
                const notification = document.createElement('div');
                notification.className = 'fixed top-20 right-4 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full opacity-0';
                notification.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span class="font-medium">Sign out failed. Please try again.</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Animate in
                setTimeout(() => {
                    notification.classList.remove('translate-x-full', 'opacity-0');
                    notification.classList.add('translate-x-0', 'opacity-100');
                }, 100);
                
                // Auto remove after 4 seconds
                setTimeout(() => {
                    notification.classList.add('translate-x-full', 'opacity-0');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 4000);
            }
        });
    </script>
    <!-- Lightweight Instructions Modal -->
    <div id="instructions-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <div class="modal-title-icon"></div>
                    How to Use the Calculator
                </h3>
                <button id="close-modal-btn" class="modal-close-btn"></button>
            </div>
            
            <div class="modal-body">
                <p>Welcome! This tool helps you calculate Rotaract Club invoices quickly and accurately.</p>
                
                <h4>
                    <span class="step-number">1</span>
                    Add Members
                </h4>
                <ul>
                    <li><strong>Individual:</strong> Fill the form with member name, club base, and join date</li>
                    <li><strong>Bulk Upload:</strong> Upload Excel or CSV files with your member roster</li>
                    <li><strong>Templates:</strong> Use our CSV template or Google Sheets template for the correct format</li>
                </ul>

                <h4>
                    <span class="step-number">2</span>
                    Manage Roster
                </h4>
                <ul>
                    <li><strong>View:</strong> See all members in the organized table</li>
                    <li><strong>Edit:</strong> Click edit to modify member information</li>
                    <li><strong>Remove:</strong> Delete members as needed</li>
                </ul>

                <h4>
                    <span class="step-number">3</span>
                    Configure Settings
                </h4>
                <ul>
                    <li><strong>Invoice Year:</strong> Select the calculation year</li>
                    <li><strong>Tax Rate:</strong> Adjust tax percentage as applicable</li>
                    <li><strong>Auto-update:</strong> Calculations update in real-time</li>
                </ul>

                <h4>
                    <span class="step-number">4</span>
                    Save to Cloud
                </h4>
                <ul>
                    <li><strong>Sign In:</strong> Click "Sign in" to access cloud storage</li>
                    <li><strong>Save Button:</strong> Use the green "Save to Cloud" button to backup your data</li>
                    <li><strong>Data Sync:</strong> Access your roster from any device when signed in</li>
                    <li><strong>Smart Loading:</strong> Choose between current session and cloud data.</li>
                </ul>

                <h4>
                    <span class="step-number">5</span>
                    Generate Report
                </h4>
                <ul>
                    <li><strong>PDF Download:</strong> Get a detailed report with all calculations</li>
                    <li><strong>Summary:</strong> Includes dues breakdown and tax calculations</li>
                    <li><strong>Member Roster:</strong> Includes all members with their dues breakdown</li>
                </ul>

                <div class="modal-tips">
                    <h4> Quick Tips</h4>
                    <ul>
                        <li><strong>Google Sheets Template:</strong> Best for easy editing and collaboration - automatically creates a copy in your Google Drive</li>
                        <li><strong>CSV Template:</strong> Best for quick downloads and offline editing</li>
                        <li><strong>Cloud Backup:</strong> Always save your work to the cloud to prevent data loss</li>
                        <li><strong>Cross-Device Access:</strong> Sign in on any device to access your saved roster</li>
                        <li>Verify join dates for accurate calculations</li>
                        <li>Download the PDF to save your estimates</li>
                    </ul>
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="got-it-btn" class="modal-btn">
                     Got it! Let's Start Calculating
                </button>
            </div>
        </div>
    </div>
</body>
</html>